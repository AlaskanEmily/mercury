#!/bin/sh
#---------------------------------------------------------------------------#
# Copyright (C) 2001 The University of Melbourne.
# This file may only be copied under the terms of the GNU General
# Public License - see the file COPYING in the Mercury distribution.
#---------------------------------------------------------------------------#

# This script merges changes to the trunk into the mode-constraints branch of
# the compiler.  It should be executed from within the mercury/
# directory in a checked-out version of the mode-constraints branch.

sync_tag_file=.mode-constraints-sync-tag

if [ ! -f $sync_tag_file ]
then
    echo $sync_tag_file: file not found
    exit 1
fi

old_tag=`cat $sync_tag_file`
new_tag=trunk_snapshot_`date +%Y%m%d%H%M%S`

echo old tag: $old_tag
echo new tag: $new_tag

cvs rtag $new_tag mercury tests
cvs update -j$old_tag -j$new_tag

rm -f $sync_tag_file
echo $new_tag >$sync_tag_file
