#-----------------------------------------------------------------------------#

main_target: check

include ../Mmake.common

#-----------------------------------------------------------------------------#

DEBUGGER_PROGS=	\
	debugger_regs	\
	interpreter	\
	queens

MCFLAGS = --generate-trace $(EXTRA_MCFLAGS)

# Not all grades can be used with stack layouts
#
ifeq ($(GRADE),jump) 
	PROGS=
else
	ifeq ($(GRADE),fast)
		PROGS=
	else
		PROGS=$(DEBUGGER_PROGS)
	endif
endif

#-----------------------------------------------------------------------------#

debugger_regs.out: debugger_regs debugger_regs.inp
	mdb ./debugger_regs < debugger_regs.inp > debugger_regs.out

interpreter.out: interpreter interpreter.inp
	mdb ./interpreter interpreter.m < interpreter.inp > interpreter.out

queens.out: queens queens.inp
	mdb ./queens < queens.inp > queens.out

#-----------------------------------------------------------------------------#

DEPS=	$(PROGS:%=%.dep)
DEPENDS=$(PROGS:%=%.depend)
OUTS=	$(PROGS:%=%.out)
RESS=	$(PROGS:%=%.res)
MODS=	$(PROGS:%=%.mod)

#-----------------------------------------------------------------------------#

dep:	$(DEPS)

depend:	$(DEPENDS)

check:	$(OUTS) $(RESS)

mods:	$(MODS)

all:	$(PROGS)

#-----------------------------------------------------------------------------#
