#!/bin/sh
# create a vi style tags file for the Mercury programs named on the command line
awk -e '
/^:- pred /	{
			left = index($3, "(");
			dot = index($3, ".");

			if (left > 0)
				pred = substr($3, 1, left-1);
			else if (dot > 0)
				pred = substr($3, 1, dot-1);
			else
				pred = $3;

			printf "%s\t%s\t/^%s$/\n", pred, FILENAME, $0;
		}
' "$@" | sort > tags
