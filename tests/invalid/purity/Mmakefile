#-----------------------------------------------------------------------------#

THIS_DIR = invalid/purity

PROGS= \
	impure_func_t2 \
	impure_func_t3 \
	impure_func_t4 \
	impure_func_t5 \
	impure_func_t7 \
	impure_pred_t1 \
	impure_pred_t2 \
	purity \
	purity_nonsense \
	purity_type_error

TESTS=$(PROGS)
SUBDIRS=
TESTS_DIR=../..
include $(TESTS_DIR)/Mmake.common

# These tests all get spurious failures with intermodule optimization,
# because the errors get detected when creating the `.opt' file rather
# than when compiling the main module.  So we disable intermodule optimization
# for these tests.
override EXTRA_MCFLAGS += --no-intermodule-optimization

# Module-specific options should go in Mercury.options so they
# can be found by `mmc --make'.
include Mercury.options

%.runtest: %.err_res ;

#-----------------------------------------------------------------------------#

# With `mmc --make', errors should go only to the `.err' file,
# not stderr.
ifeq ($(MMAKE_USE_MMC_MAKE),yes)
%.err: %.m
	if $(MCM) $*.err > /dev/null 2>&1 ; then false; else true; fi
else
%.err: %.m
	if $(MC) $(ALL_GRADEFLAGS) $(ALL_MCFLAGS) --errorcheck-only $* \
		> $*.err 2>&1; \
	then false; else true; fi
endif

clean_local:
	rm -f *.err *.err_res

#-----------------------------------------------------------------------------#
