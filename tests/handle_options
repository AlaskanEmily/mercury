usage="\
Usage: $0 [options]
Options:
	-f <mcflags>, --flags <mcflags>
		Pass MCFLAGS=<mcflags> as an option to \`mmake check'.
	-g <grade>, --grade <grade>
		Pass GRADE=<grade> as an option to \`mmake check'.
	-j <num-jobs>, --jobs <num-jobs>
		Run using <num-jobs> different parallel processes.
"

jfactor=""
flagsopt=""
gradeopt=""
fflag=""
gflag=""

while [ $# -gt 0 ]; do
	case "$1" in

	-f|--flags)
		fflag="-f $2"
		flagsopt="MCFLAGS=$2"
		shift ;;

	-g|--grade)
		gflag="-g $2"
		gradeopt="GRADE=$2"
		shift ;;

	-j|--jobs)
		jfactor="-j$2"; shift ;;
	-j*)
		jfactor="-j` expr $1 : '-j\(.*\)' `" ;;
	--jobs*)
		jfactor="--jobs` expr $1 : '--jobs\(.*\)' `" ;;

	--)	
		shift; break ;;
	-*)
		echo "$0: unknown option \`$1'" 1>&2
		echo "$usage" 1>&2
		exit 1 ;;
	*)
		break ;;
	esac
	shift
done

if [ $# -ne 0 ]; then
	echo "$0: unexpected argument(s) \`$*'" 1>&2
	echo "$usage" 1>&2
	exit 1
fi
