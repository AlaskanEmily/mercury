\input texinfo
@setfilename mercury_user_guide.info
@settitle The Mercury User's Guide

@ignore
@ifinfo
@format
START-INFO-DIR-ENTRY
* Mercury: (mercury).                The Mercury User's Guide.
END-INFO-DIR-ENTRY
@end format
@end ifinfo
@end ignore

@c @smallbook
@c @cropmarks
@c @finalout
@setchapternewpage odd
@ifinfo
This file documents the Mercury implementation.

Copyright (C) 1995 University of Melbourne.

Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

@ignore
Permission is granted to process this file through Tex and print the
results, provided the printed document carries copying permission
notice identical to this one except for the removal of this paragraph
(this paragraph not being relevant to the printed manual).

@end ignore
Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided also that
the entire resulting derived work is distributed under the terms of a
permission notice identical to this one.

Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions.
@end ifinfo

@titlepage
@c @finalout
@title The Mercury User's Guide
@subtitle BETA TEST version, July 1995
@author Fergus Henderson
@author Thomas Conway
@author Zoltan Somogyi
@page
@vskip 0pt plus 1filll
Copyright @copyright{} 1995 University of Melbourne.

Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided also that
the entire resulting derived work is distributed under the terms of a
permission notice identical to this one.

Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions.
@end titlepage
@page

@iftex
@chapter Getting Started
@end iftex
@node Top,,, (DIR)
@ifinfo
@chapter The Mercury User's Guide - BETA TEST version, July 1995
@end ifinfo

This document describes the compilation environment of Mercury.
It describes how to use @samp{mc}, the Mercury compiler,
and @samp{mmake} or ``Mercury make'',
a tool built on top of ordinary or GNU make
to simplify the handling of Mercury programs.

Mercury is a compiled language like C or Pascal,
not an interpreted one like Prolog or Lisp.
Therefore the debugging of Mercury programs
requires a dedicated Mercury debugger program,
since there is no interpreter to serve in its place.
Until the Mercury debugger is complete,
Mercury programmers may wish to use a Prolog system
to execute their Mercury programs in order to gain access to this facility.
The feasibility of this technique is dependent upon the program
being written in the intersection of the Prolog and Mercury languages,
which is possible because the two languages have almost the same syntax.
This guide therefore also documents how to run a Mercury program
using NU-Prolog or SICStus Prolog.

@menu
* Filenames::       File naming conventions
* Using mc::        Compiling and linking programs with the Mercury compiler
* Using Prolog::    Building and debugging Mercury programs with Prolog
* Using Mmake::     ``Mercury Make'', a tool for building Mercury programs
* Invocation::      List of options for the Mercury compiler
* Environment::     Environment variables used by the compiler and utilities.
@end menu

@node Filenames, Using mc,, Top
@section File naming conventions

Mercury source files should be named @file{*.m}.
Each Mercury source file must contain a single Mercury module
whose name should be the same as the filename without
the @samp{.m} extension.

Files ending in @file{.int} and @file{.int2} are interface files;
these are generated automatically by the compiler,
using the @samp{--make-interface} option.
(The @file{.int} files are for direct dependencies,
while the @file{.int2} files are a shorter version
used for indirect dependencies.)

Since the interface of a module changes less often than its implementation,
the @file{.int} and @file{.int2} files will remain unchanged
on many compilations.
To avoid unnecessary recompilations of the clients of the module,
the timestamps on the @file{.int} and @file{.int2} files
are updated only if their contents change.
A @file{.date} file associated with the module is used as a date stamp;
it is used when deciding whether the interface files need to be regenerated.

Files ending in @file{.d} are automatically-generated Makefile fragments
which contain the dependencies for a module.
Files ending in @file{.dep} are automatically-generated Makefile fragments
which contain the rules for an entire program.

In the source code for the Mercury runtime library,
we use a few files ending in @file{.mod};
these are preprocessed using the perl script mod2c to produce C files.
Originally the Mercury compiler also produced @file{.mod} files,
but now we compile directly to C.

As usual, @file{.c} files are C source code, @file{.o} files are object code,
@file{.no} files are NU-Prolog object code, and
@file{.ql} files are SICStus Prolog object code.

@node Using mc, Using Prolog, Filenames, Top
@chapter Using the Mercury compiler

Following a long Unix tradition,
the Mercury compiler is called @samp{mc}.
To reduce learning time,
its options are deliberately modelled
on the option sets of other Unix compilers.

Arguments to @samp{mc} that name Mercury source files
may omit the @samp{.m} suffix.

To compile a program which consists of just a single module,
use the command

@example
mc @var{module}.m
@end example

@samp{mc} will put the executable into a file called `@var{module}',
since this is more useful than putting it into @file{a.out}.

To compile a module to object code without creating an executable,
use the command

@example
mc -c @var{module}.m
@end example

@samp{mc} will put the object code into a file called `@file{@var{module}.o}'.
It will leave the intermediate C code in a file called `@file{@var{module}.c}',
since at this point in time it is likely that
many Mercury users will be interested to see the C code.

Before you can compile a module,
you must make the interface files
for the modules that it imports (directly or indirectly).
You can create the interface files for one or more modules using the command

@example
mc -i @var{module1}.m ...
@end example

Given that you have made all the interface files,
one way to create an executable for a multi-module program
is to compile all the modules at the same time
using the command

@example
mc @var{module1}.m @var{module2}.m ...
@end example

This will put the resulting executable in @var{module1}.
If you use this approach, we recommend that
@var{module1} be the main module of the program.

The other way to create an executable for a multi-module program
is to compile each module separately using @samp{mc -c},
and then link the resulting object files together.
The linking is a two stage process.

First, you must create and compile an @emph{initialization file},
which is a C source file
containing calls to automatically generated initialization functions
contained in the C code of the modules of the program:

@example
c2init @var{module1}.c @var{module2}.c ... > @var{main_module}_init.c,
mgnuc -c @var{main_module}_init.c
@end example

The @samp{c2init} command line must contain
the name of the C file of every module in the program.
The order of the arguments is not important.
The @samp{mgnuc} command is the Mercury GNU C compiler;
it is a shell script that invokes the GNU C compiler
(or some other C compiler if GNU C is not available)
with the options appropriate for compiling
the C programs generated by Mercury.

You then link the object code of each module
with the object code of the initialization file to yield the executable:

@example
ml -o @var{main_module} @var{module1}.o @var{module2}.o ... @var{main_module2}_init.o
@end example

@samp{ml}, the Mercury linker, is another shell script
that invokes a C compiler with options appropriate for Mercury,
this time for linking.

This command puts the executable in the file @var{main_module}.
The same command line without the -o option
would put the executable into the file @file{a.out}.

@samp{mc} and @samp{ml} both accept a @samp{-v} (verbose) option.
You can use that option to see what is actually going on.
For the full set of options of @samp{mc}, see @pxref{Invocation}.

Once you have created an executable for a Mercury program,
the scheme for invoking it is

@example
./@var{executable} @var{runtime-options} -- @var{arguments}
@end example

The @samp{--} separates the options to the Mercury runtime
from the options to your program.
Invoking the program with @samp{-h}
will list the available @var{runtime-options}.
The most useful of these are the options that set the size of the stacks.

The det stack and the nondet stack
are allocated fixed sizes at program start-up.
The default size is 512k for the det stack and 128k for the nondet stack,
but these can be overridden with the @samp{-sd} and @samp{-sn} options,
whose arguments are the desired sizes of the det and nondet stacks
respectively, in units of kilobytes.
The Mercury runtime will ensure that stack overflow
is trapped by the virtual memory system,
on operating systems that support that.

With conservative garbage collection (the default),
the heap will start out with a zero size,
and will be dynamically expanded as needed,
When not using conservative garbage collection,
the heap has a fixed size like the stacks.
The default size is 40 Mb, but this can be overridden
with the @samp{-sh} option.

@node Using Prolog, Using Mmake, Using mc, Top
@chapter Using Prolog

Mercury programmers may wish to run their programs using a Prolog system
to gain the use of the debugging facilities of the Prolog implementation,
at least until the Mercury debugger is complete.
Hwoever, there is no point in using a Prolog debugger to track down a bug
that can be detected statically by the Mercury compiler.
The command

@example
mc -e @var{module1}.m ...
@end example

causes the Mercury compiler
to perform all its syntactic and semantic checks on the named modules,
but not to generate any code.

In our experience, omitting that step is not wise.
If you do omit it, you often waste a lot of time
debugging problems that the compiler could have detected for you.

@menu
* Using NU-Prolog:: Building and debugging Mercury programs with NU-Prolog
* Using SICStus::   Building and debugging Mercury programs with SICStus Prolog
* Prolog hazards::  The hazards of executing Mercury programs using Prolog
@end menu

@node Using NU-Prolog, Using SICStus,, Using Prolog
@section Using NU-Prolog

You can compile a Mercury source module using NU-Prolog via the command

@example
mnc @var{module1}.m ...
@end example

@samp{mnc} is the Mercury variant of nc, the NU-Prolog compiler.
It adapts nc to compile Mercury programs,
e.g. by defining do-nothing predicates for the various Mercury declarations
(which are executed by nc).

Some invocations of @samp{mnc} will result in warnings such as

@example
Warning: main is a system predicate.
It shouldn't be used as a non-terminal.
@end example

and/or warnings such as

@example
%       Miscellaneous error. Try running NIT.
%       Unification with unique variable.
@end example

Such warnings should be ignored.

@samp{mnc} compiles the modules it is given into NU-Prolog bytecode,
stored in files with a @file{.no} suffix.
You can link these together using the command

@example
mnl -o @var{main_module} @var{module1}.no ...
@end example

Ignore any warnings such as

@example
Warning: main/2 redefined
@end example

@samp{mnl}, the Mercury NU-Prolog linker,
will put the executable (actually a shell script invoking a save file)
into the file @var{main_module}.
This can be executed normally using

@example
./@var{main_module} @var{arguments}
@end example

Alternatively, one can execute such programs using @samp{mnp},
the Mercury version of np, the NU-Prolog interpreter.
The command

@example
mnp
@end example

will start up the Mercury NU-Prolog interpreter.
Inside the interpreter, you can load your source files
with a normal consulting command such as

@example
[@var{module}].
@end example

Alternately, you can use the @file{--debug} option to @samp{mnl} when linking.
This will produce an executable whose entry point is the NU-Prolog interpreter,
rather than main/2 in your program.

In both cases, you can start executing your program by typing

@example
r("@var{main_module} @var{arguments}").
@end example

at the prompt of the NU-Prolog interpreter.

All the NU-Prolog debugging commands work as usual.
The most useful ones are
the @code{trace} and @code{spy} commands at the main prompt
to turn on complete or selective tracing respectively,
and the @code{l} (leap), @code{s} (skip), and @code{r} (redo)
commands of the tracer.
For more information, see the NU-Prolog documentation.

By default the debugger only displays the top levels of terms;
you can use the @code{|} command to enter an interactive term browser.
Also note that in the debugger, we use a version of @code{error/1}
which fails rather than aborting after printing the "Software Error:" message.
This makes debugging easier,
but will of course change the behaviour after an error occurs.

@node Using SICStus, Prolog hazards, Using NU-Prolog, Using Prolog
@section Using SICStus Prolog

Using SICStus Prolog is similar to using NU-Prolog,
except that the commands to use are @samp{msc}, @samp{msl}, and
@samp{msp} rather than @samp{mnc}, @samp{mnl}, and @samp{mnp}.

Due to shortcomings in SICStus Prolog
(in particular, the lack of backslash escapes in character strings),
you need to use @samp{sicstus_conv} to convert Mercury @samp{.m} files
to the @samp{.pl} files that SICStus Prolog expects
before you can load them into the interpreter.
The command to use is just

@example
sicstus_conv @var{module}.m
@end example

@node Prolog hazards,, Using SICStus, Using Prolog
@section Hazards of using Prolog

There are some Mercury programs which are not valid Prolog programs.
In particular, Mercury will always reorder goals
to ensure that they are mode-correct
(or report a mode error if it cannot do so),
but Prolog systems will not always do so,
and will sometimes just silently give the wrong result.
For example, in Mercury the following predicate will usually succeed,
whereas in NU-Prolog it will always fail.

@example
:- pred p(list(int)::in, list(int)::out) is semidet.
p(L0, L) :-
        L \= [],
        q(L0, L).

:- pred q(list(int)::in, list(int)::out) is det.
@end example

The reason is that in Mercury,
the test @samp{L \= []} is reordered to after the call to @code{q/2},
but in NU-Prolog, it executes even though @code{L} is not bound,
and consequently the test always fails.

(NU-Prolog has logical alternatives
to non-logical Prolog operations such as @samp{\=},
but during the development of the Mercury compiler
we had to abandon their use for efficiency reasons.)

Another hazard is that NU-Prolog does not have a garbage collector.

@node Using Mmake, Invocation, Using Prolog, Top
@chapter Using Mmake

Mmake, short for ``Mercury Make'',
is a tool for building Mercury programs
that is built on top of ordinary or GNU Make @footnote{
We aim to eventually add support for ordinary `Make' programs,
but currently only GNU Make is supported.}.
With Mmake, building even a complicated Mercury program
consisting of a number of modules is as simple as

@example
mmake @var{main-module}.depend
mmake @var{main-module}
@end example

Mmake only recompiles those files that need to be recompiled,
based on automatically generated dependency information.
Most of the dependencies are stored in @file{.d} files that are
automatically recomputed every time you recompile,
so they are never out-of-date.
A little bit of the dependency information is stored in @file{.dep} files
which are more expensive to recompute.
The @samp{mmake @var{main-module}.depend} command
which recreates the @file{@var{main-module}.dep} file
needs to be repeated only when you add or remove a module from your program,
and there is no danger of getting an inconsistent executable
if you forget this step --- instead you will get a compile or link error.

@samp{mmake} allows you to build more than one program in the same directory.
Each program must have its own @file{.dep} file,
and therefore you must run @samp{mmake @var{program}.depend}
for each program.

If there is a file called @samp{Mmake} in the current directory,
Mmake will include that file in its automatically-generated Makefile.
The @samp{Mmake} file can override the default values of
various variables used by Mmake's builtin rules, listed below,
or it can add additional rules, dependencies, and actions.

Mmake's builtin rules are defined by the file
@file{@var{prefix}/lib/mercury/mmake/Mmake.rules}
(where @var{prefix} is @file{/usr/local} by default)
as well as the rules in the automatically-generated @file{.dep} files.
These rules define the following targets:

@table @file
@item @var{main-module}.depend
Creates the file @file{@var{main-module}.dep} from @file{@var{main-module}.m}
and the modules it imports.
This step must be performed first.

@item @var{main-module}.ints
Ensure that the interface files for @var{main-module}
and its imported modules are up-to-date.
(If the underlying @samp{make} program does not handle transitive dependencies,
this step may be necessary before
attempting to make @file{@var{main-module}} or @file{@var{main-module}.check};
if the underlying @samp{make} is GNU Make, this step should not be necessary.)

@item @var{main-module}.check
Perform semantic checking on @var{main-module} and its imported modules.
Error messages are placed in @file{.err} files.

@item @var{main-module}
Compiles and links @var{main-module} using the Mercury compiler.
Error messages are placed in @file{.err2} files.

@item @var{main-module}.nu
Compiles and links @var{main-module} using NU-Prolog.

@item @var{main-module}.nu.debug
Compiles and links @var{main-module} using NU-Prolog.
The resulting executable will start up in the NU-Prolog interpreter
rather than calling main/2.

@item @var{main-module}.sicstus
Compiles and links @var{main-module} using SICStus Prolog.

@item @var{main-module}.sicstus.debug
Compiles and links @var{main-module} using SICStus Prolog.
The resulting executable will start up in the SICStus Prolog interpreter
rather than calling main/2.

@item @var{main-module}.clean
Removes the automatically generated files
that contain the compiled code of the program.
These are the files
@file{@var{module}.c}, @file{@var{module}.s}, @file{@var{module}.o}, @file{@var{module}.no} and @file{@var{module}.ql}
belonging to one of the modules of the program.

@item @var{main-module}.realclean
Removes all the automatically generated files
that @var{main-module}.clean removes,
plus the files with the suffixes
@file{@var{module}.err} @file{@var{module}.date} @file{@var{module}.int} @file{@var{module}.int2}
and @file{@var{module}.d}
@file{.dep}
@file{.d}
@file{.d}
belonging to one of the modules of the program.

@item clean
@item realclean
Like @samp{clean}, but also removes the executables and the dependency files.

@end table

The variables used by the builtin rules are defined in
@file{@var{prefix}/lib/mercury/mmake/Mmake.vars}.

@node Invocation, Environment, Using Mmake, Top
@chapter Invocation

This section contains a brief description of all the options
available for @samp{mc}, the Mercury compiler.
Sometimes this list is a little out-of-date;
use @samp{mc --help} to get the most up-to-date list.

@code{mc} is invoked as
@example
mc [@var{options}] @var{modules}
@end example

For module names, the trailing @file{.m} is optional.

Options are either short (single-letter) options preceded by a single @samp{-},
or long options preceded by @samp{--}.
Options are case-sensitive.
We call options that do not take arguments @dfn{flags}.
Single-letter flags may be grouped with a single @samp{-}, e.g. @samp{-vVc}.
Single-letter flags may be negated
by appending another trailing @samp{-}, e.g. @samp{-v-}.
Long flags may be negated by preceding them with @samp{no-},
e.g. @samp{--no-verbose}.

@section Warning Options:
@table @code
@item -w
@itemx --inhibit-warnings
Disable all warning messages.

@item --no-warn-singleton-variables
Don't warn about variables which only occur once.

@item --no-warn-missing-det-decls
Don't warn about predicate declarations which don't
have a determinism annotation.

@item --no-warn-det-decls-too-lax
Don't warn about determinism declarations
which could have been stricter.
@end table

@section Verbosity Options:
@table @code
@item -v
@itemx --verbose
Output progress messages at each stage in the compilation.

@item -V
@itemx --very_verbose
Output very verbose progress messages.

@item -E
@itemx --verbose-error-messages
Explain error messages.  Asks the compiler to give you a more
detailed explanation of any errors it finds in your program.

@item -S
@itemx --statistics
Output messages about the compiler's time/space usage.
At the moment this option implies @samp{--no-trad-passes},
so you get information at the boundaries between phases of the compiler.

@item -T
@itemx --debug-types
Output detailed debugging traces of the type checking.

@item -N
@itemx --debug-modes
Output detailed debugging traces of the mode checking.

@item --vndebug <n>
Output detailed debugging traces of the value numbering optimization pass.
The different bits in the number argument of this option control the
printing of different types of tracing messages.
@end table

@section Output Options:
@table @code
@item -M
@itemx --generate-dependencies
Output `Make'-style dependencies for the module
and all of its dependencies to @file{@var{module}.dep}.
Only syntax analysis will be performed - this option
disables all the later phases of compilation.

@item -i
@itemx --make-interface
Write the module interface to @file{@var{module}.int}.
Also write the short interface to @file{@var{module}.int2}.
As with -M, this disables type-checking, etc.

@item --show-dependency-graph
Write out the dependency graph to @var{module}.dependency_graph.

@item -G
@itemx --convert-to-goedel
Convert to Goedel. Output to file @file{@var{module}.loc}
As with -M, this disables type-checking, etc.

@item -P
@itemx --convert-to-mercury
Convert to Mercury. Output to file @file{@var{module}.ugly}
This option acts as a Mercury ugly-printer.
As with -M, it disables type-checking, etc.

@item --no-modecheck
Don't invoke the mode analysis and later passes of the compiler.
Just check the syntax and type-correctness of the code.
When converting Prolog code to Mercury,
it can be useful to get the types right first
and worry about modes second;
this option supports that approach.

@item -d @var{stage}
@itemx --dump-hlds @var{stage}
Dump the HLDS (intermediate representation) after
the specified stage number or stage name to
@file{@var{module}.hlds_dump.@var{num}-@var{name}}.
Stage numbers range from 0 to 17.
Multiple dump options accumulate.

@item -D
@itemx --verbose-dump-hlds
With @samp{--dump-hlds}, dumps some additional info.

@item -e
@itemx --errorcheck-only
Check the module for errors, but do not generate any code.

@item -C
@itemx --compile-to-c
@itemx --compile-to-C
Generate C code in @file{@var{module}.c}, but not object code.

@item -c
@itemx --compile-only
Generate C code in @file{@var{module}.c}
and object code in @file{@var{module}.o}
but do not attempt to link the named modules.

@item --auto-comments
Output comments in the @file{@var{module}.c} file.
This is primarily useful for trying to understand
how the generated C code relates to the source code,
e.g. in order to debug the compiler.

@item -l
@itemx --line-numbers
Output source line numbers in the generated code.
Only works with the -G and -M options.

@c @item -p
@c @itemx --profiling
@c Output to file <module>.prof the profiling info.
@end table

@section Code generation options
@table @code
@item --no-trad-passes
Generate code by phases, not by predicates.

@c @item --no-polymorphism
@c Don't handle polymorphic types.
@c (Generates slightly more efficient code, but stops
@c polymorphism from working except in special cases.)

@item -s @var{grade}
@itemx --grade @var{grade}
Select the compilation model.  This is a convenient way of
selecting a setting for the @samp{--c-optimize}, @samp{--gc},
@samp{--gcc-global-registers}, @samp{--gcc-non-local-gotos},
@samp{--asm-labels}, and @samp{--debug} options simultaneously.
@var{grade} should be one of
@{@samp{debug, none, reg, jump, asm_jump, fast, asm_fast}@}
or one of those with @file{.gc} appended.

@item --gc @{none, conservative, accurate@}
@itemx --garbage-collection @{none, conservative, accurate@}
Specify which method of garbage collection to use (default: @samp{none}).
@samp{accurate} is not yet implemented.

@item --no-follow-code
Don't migrate builtin goals into branched goals.

@item --no-follow-vars
Don't optimise the assignment of registers in branched goals.

@item --no-reclaim-heap-on-nondet-failure
Don't reclaim heap on backtracking in nondet code.

@item --no-reclaim-heap-on-semidet-failure
Don't reclaim heap on backtracking in semidet code.

@item --use-macro-for-redo-fail
Emit the fail or redo macro instead of a branch
to the fail or redo code in the runtime system.

@item --no-gcc-global-registers
Don't use GNU C's global register variables extension.

@item --no-gcc-non-local-gotos
Don't use GNU C's "labels as values" extension.

@item --no-asm-labels
Don't use inline assembler labels.

@item --tags @{none, low, high@}
Specify whether to use the low bits or the high bits of
each word as tag bits (default: low).

@item --num-tag-bits @var{n}
Use @var{n} tag bits (only used with @samp{--tags high}).

@item --cc @var{compiler-name}
Specify which C compiler to use.

@item --c-include-directory @var{dir}
Specify the directory containing the Mercury C header files.

@item --cflags @var{options}
Specify options to be passed to the C compiler.

@item --debug
Pass the -g flag to the C compiler to enable debugging of the generated C code.
This option is probably not useful to anyone except the Mercury implementors.
@end table

@section Optimization Options
@table @code
@item --no-optimize
Disable the optimisation passes.

@item --no-optimize-peep
Disable local peephole optimisations.

@item --no-optimize-jumps
Disable elimination of jumps to jumps.

@item --no-optimize-fulljumps
Disable elimination of jumps to ordinary code.

@item --no-optimize-labels
Disable elimination of dead labels and code.

@item --optimize-value-number
Perform value numbering. Use of this option together with
conservative garbage collection requires a collector compiled
with @samp{-DALL_INTERIOR_POINTERS}.

@c @item --pred-value-number
@c Extend value numbering to whole predicates, rather than just basic blocks.

@item --no-optimize-frames
Disable stack frame optimizations.

@item --optimize-repeat @var{n}
Iterate most optimizations at most @var{n} times (default: 3).

@item --optimize-vnrepeat @var{n}
Iterate value numbering at most @var{n} times (default: 1).

@item --no-static-ground-terms
Disable the optimization of constructing constant ground terms
at compile time and storing them as static constants.

@item --no-smart-indexing
Generate switches as a simple if-then-else chains;
disable string hashing and integer table-lookup indexing.

@item --req-density @var{percentage}
The jump table generated for an atomic switch
must have at least this percentage of full slots (default: 25).

@item --dense-switch-size @var{size}
The jump table generated for an atomic switch
must have at least this many entries (default: 4).

@item --string-switch-size @var{size}
The hash table generated for a string switch
must have at least this many entries (default: 8).

@item --tag-switch-size @var{size}
The number of alternatives in a tag switch
must be at least this number (default: 8).

@item --no-middle-rec
Disable the middle recursion optimization.

@item --no-inlining
Disable the inlining of simple procedures.

@c @item --common-struct
@c Enable optimisation of common term structures.

@item --no-common-goal
Disable optimisation of common goals.
At the moment this optimisation
detects only common deconstruction unifications.
Disabling this optimisation reduces the class of predicates
that the compiler considers to be deterministic.

@item --procs-per-c-function @var{n}
Don't put the code for more than @var{n} Mercury
procedures in a single C function.  The default
value of @var{n} is one.  Increasing @var{n} can produce
slightly more efficient code, but makes compilation slower.
Setting @var{n} to the special value zero has the effect of
putting all the procedures in a single function,
which produces the most efficient code
but tends to severely stress the C compiler.

@c @item --constraint-propagation
@c Enable the constraint propagation tranformation.

@item --no-c-optimize
Don't enable the C compiler's optimizations.
@end table

@section Miscellaneous Options:
@table @code
@item -b @var{builtin}
@itemx --builtin-module @var{builtin}
Use @var{builtin} instead of @samp{mercury_builtin} as the
module which always gets automatically imported.

@item -I @var{dir}
@itemx --search-directory @var{dir}
Append @var{dir} to the list of directories to be searched for 
imported modules.

@item -h
@itemx --help
Print a usage message.

@c @item -H @var{n}
@c @itemx --heap-space @var{n}
@c Pre-allocate @var{n} kilobytes of heap space.
@c This option is now obsolete.  In the past it was used to avoid
@c NU-Prolog's "Panic: growing stacks has required shifting the heap"
@c message.
@end table

@node Environment,, Invocation, Top
@chapter Environment Variables

The shell scripts in the Mercury compilation environment
use the following environment variables.

@table @code
@item MERCURY_C_INCL_DIR
Directory for the Mercury C header files (@file{*.h}).

@item MERCURY_INT_DIR
Directory for the Mercury library interface
files (@file{*.int} and @file{*.int2}).

@item MERCURY_NC_BUILTIN
Filename of the Mercury `nc'-compatibility file (nc_builtin.nl).

@item MERCURY_C_LIB_DIR
Base directory containing the Mercury libraries (@file{libmer.a} and
possibly @file{libmer.so}) for each configuration and grade.
The libraries for each configuration and grade should
be in the subdirectory @var{config}/@var{grade} of @code{$MERCURY_C_LIB_DIR}.

@item MERCURY_MOD_LIB_DIR
The directory containing the .init files in the Mercury library.
They are used to create the initialization file @file{*_init.c}.

@item MERCURY_MOD_LIB_MODS
The names of the .init files in the Mercury library.

@item MERCURY_NU_LIB_DIR
Directory for the NU-Prolog object files (@file{*.no}) for the
NU-Prolog Mercury library.

@item MERCURY_NU_LIB_OBJS
List of the NU-Prolog object files (@file{*.no}) for the Mercury
library.

@item MERCURY_COMPILER
Filename of the Mercury Compiler.

@item MERCURY_INTERPRETER
Filename of the Mercury Interpreter.

@item MERCURY_MKINIT
Filename of the program to create the @file{*_init.c} file.

@item MERCURY_DEFAULT_GRADE
The default grade to use if no @samp{--grade} option is specified.

@end table

@contents
@bye
