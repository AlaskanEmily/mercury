#! /bin/sh
# @configure_input@
#---------------------------------------------------------------------------#
# Copyright (C) 1994-1998, 2000-2002 The University of Melbourne.
# This file may only be copied under the terms of the GNU General
# Public License - see the file COPYING in the Mercury distribution.
#---------------------------------------------------------------------------#
#
# MMC - Melbourne Mercury Compiler.
#
# Use `mmc -h' for help.
#
# Environment variables: MERCURY_INT_DIR, MERCURY_C_INCL_DIR,
# MERCURY_ALL_MC_C_INCL_DIRS,
# MERCURY_COMPILER, MERCURY_C_COMPILER,
# MERCURY_DEFAULT_GRADE, MERCURY_DEFAULT_OPT_LEVEL.

MERC_C_INCL_DIR=${MERCURY_C_INCL_DIR=@LIBDIR@/inc}
MERC_ALL_MC_C_INCL_DIRS=${MERCURY_ALL_MC_C_INCL_DIRS="--c-include-directory $MERC_C_INCL_DIR"}
MC=${MERCURY_COMPILER="@LIBDIR@/bin/@FULLARCH@/mercury_compile"}
INTDIR=${MERCURY_INT_DIR=@LIBDIR@/ints}

# The default options settings are passed in the DEFAULT_MCFLAGS enviroment
# variable, rather than on the command line, so that they can be overridden
# by the value of MCFLAGS in the Mercury.options file. 
#
# The default optimization level should be after
# all the options that describe the machine configuration.
DEFAULT_MCFLAGS="\
		$MERC_ALL_MC_C_INCL_DIRS \
		--cc \"${MERCURY_C_COMPILER=@CC@}\" \
		--grade \"${MERCURY_DEFAULT_GRADE=@DEFAULT_GRADE@}\" \
		--cflags-for-threads \"@CFLAGS_FOR_THREADS@\" \
		--cflags-for-regs \"@CFLAGS_FOR_REGS@\" \
		--cflags-for-gotos \"@CFLAGS_FOR_GOTOS@\" \
		--cflags-for-pic \"@CFLAGS_FOR_PIC@\" \
		--c-flag-to-name-object-file \"@OBJFILE_OPT@\" \
		--object-file-extension \".@OBJ_SUFFIX@\" \
		--fullarch \"@FULLARCH@\" \
		--num-real-r-regs \"@NUM_REAL_R_REGS@\" \
		--num-real-r-temps \"@NUM_REAL_R_TEMPS@\" \
		--conf-low-tag-bits \"@LOW_TAG_BITS@\" \
		--bits-per-word \"@BITS_PER_WORD@\" \
		--bytes-per-word \"@BYTES_PER_WORD@\" \
		--dotnet-library-version \"@MS_DOTNET_LIBRARY_VERSION@\" \
		@HAVE_DELAY_SLOT@ \
		@HAVE_BOXED_FLOATS@ \
		${MERCURY_DEFAULT_OPT_LEVEL=-O2} \
		"
export DEFAULT_MCFLAGS

case $# in
	0) exec $MC -I "$INTDIR" ;;
	*) exec $MC -I "$@" "$INTDIR" ;;
esac

