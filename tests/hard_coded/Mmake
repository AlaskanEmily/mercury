#-----------------------------------------------------------------------------#

main_target: check

include ../Mmake.common

#-----------------------------------------------------------------------------#

PROGS=	qual_basic_test qual_is_test qual_adv_test \
	pragma_c_code pragma_inline higher_order_func_test \
	free_free_mode func_test string_alignment tim_qual1 c_write_string \
	no_fully_strict float_rounding_bug string_loop func_and_pred \
	cc_nondet_disj bidirectional address_of_builtins \
	reverse_arith curry curry2 higher_order_syntax \
	ho_func_reg float_reg write expand ho_solns write_reg1 \
	ho_univ_to_type elim_special_pred division_test \
	name_mangling

#-----------------------------------------------------------------------------#

# some tests need to be compiled with particular options

MCFLAGS			=	$(MCFLAGS-$*) $(EXTRA_MCFLAGS)
MCFLAGS-func_test	=	--infer-all
MCFLAGS-no_fully_strict	=	--no-fully-strict

# no_fully_strict is expected to fail (it calls error/1)
# so we need to ignore the exit status (hence the leading `-')
no_fully_strict.out: no_fully_strict
	-./no_fully_strict > no_fully_strict.out 2>&1;

#-----------------------------------------------------------------------------#

DEPS=	$(PROGS:%=%.dep)
DEPENDS=$(PROGS:%=%.depend)
OUTS=	$(PROGS:%=%.out)
RESS=	$(PROGS:%=%.res)
MODS=	$(PROGS:%=%.mod)

#-----------------------------------------------------------------------------#

dep:	$(DEPS)

depend:	$(DEPENDS)

check:	$(OUTS) $(RESS)

mods:	$(MODS)

all:	$(PROGS)

#-----------------------------------------------------------------------------#
