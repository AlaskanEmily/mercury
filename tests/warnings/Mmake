#-----------------------------------------------------------------------------#

main_target: check

#-----------------------------------------------------------------------------#

PROGS=	pragma_c_code_unused_var unused_args_test singleton_test \
	unused_import pragma_source_file missing_if double_underscore \
	duplicate_call

#-----------------------------------------------------------------------------#

%.res:	%.exp %.err
	-rm -f $@
	diff -u $*.exp $*.err > $@

#-----------------------------------------------------------------------------#

DEPENDS=$(PROGS:%=%.depend)
ERRS=	$(PROGS:%=%.err)
RESS=	$(PROGS:%=%.res)

#-----------------------------------------------------------------------------#

duplicate_call.err:
	$(MC) --grade $(GRADE) -C --warn-simple-code --errorcheck-only \
		duplicate_call > duplicate_call.err 2>&1

unused_args_test.err:
	$(MC) --grade $(GRADE) -C --warn-unused-args --errorcheck-only \
		unused_args_test > unused_args_test.err 2>&1

unused_import.err:
	$(MC) --grade $(GRADE) -C --warn-interface-imports --errorcheck-only \
		unused_import > unused_import.err 2>&1

depend:	$(DEPENDS)

check:	$(ERRS) $(RESS)

all:	$(PROGS)

clean:	clean_err clean_res

clean_mc: clean_c clean_o clean_err clean_res

clean_err:
	rm -f *.err

clean_res:
	rm -f *.res

#-----------------------------------------------------------------------------#
